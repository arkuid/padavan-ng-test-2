<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Padavan-NG –ü—Ä–æ—à–∏–≤–∫–∏ - –ó–∞–≥—Ä—É–∑–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        .category { margin-bottom: 40px; border-left: 4px solid #2ea44f; padding-left: 15px; }
        .release { background: #f6f8fa; border: 1px solid #e1e4e8; border-radius: 6px; padding: 16px; margin: 10px 0; }
        .tag { display: inline-block; background: #2ea44f; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.9em; margin-right: 8px; }
        .file-list { margin-top: 8px; font-size: 0.9em; color: #586069; }
        a { color: #0366d6; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .loading { color: #6a737d; }
        .error { color: #cb2431; }
    </style>
</head>
<body>
    <h1>üóÉÔ∏è Padavan-NG –ü—Ä–æ—à–∏–≤–∫–∏</h1>
    <p>–ó–∞–≥—Ä—É–∑–∫–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤.</p>

    <div id="categories_container">
        <!-- –°—é–¥–∞ JavaScript –≤—Å—Ç–∞–≤–∏—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–ª–∏–∑—ã -->
        <p class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–µ–ª–∏–∑–∞—Ö...</p>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const GITHUB_USER = 'arkuid';
        const GITHUB_REPO = 'padavan-ng-test-2';
        const API_URL = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/releases`;

        // –ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è —Ä–µ–ª–∏–∑–∞
        const CATEGORY_RULES = [
            { pattern: /\[(–î–ª—è —Ä–æ—É—Ç–µ—Ä–∞ 1|router1)\]/i, name: '–î–ª—è —Ä–æ—É—Ç–µ—Ä–∞ 1' },
            { pattern: /\[(–î–ª—è —Ä–æ—É—Ç–µ—Ä–∞ 2|router2)\]/i, name: '–î–ª—è —Ä–æ—É—Ç–µ—Ä–∞ 2' },
            { pattern: /\[(Toolchain|–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)\]/i, name: 'Toolchain' },
            { pattern: /\[(–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è|Docs)\]/i, name: '–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è' }
        ];

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–µ–ª–∏–∑–∞
        function detectCategory(releaseBody, releaseName) {
            const textToCheck = (releaseBody || '') + ' ' + (releaseName || '');
            
            for (const rule of CATEGORY_RULES) {
                if (rule.pattern.test(textToCheck)) {
                    return rule.name;
                }
            }
            return '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'; // –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('ru-RU', options);
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–ª–∏–∑–æ–≤
        async function loadReleases() {
            const container = document.getElementById('categories_container');
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ GitHub API
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞ API: ${response.status}`);
                
                const releases = await response.json();
                
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ä–µ–ª–∏–∑—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                const categorized = {};
                
                releases.forEach(release => {
                    const category = detectCategory(release.body, release.name);
                    
                    if (!categorized[category]) {
                        categorized[category] = [];
                    }
                    
                    categorized[category].push(release);
                });
                
                // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –≤—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                container.innerHTML = '';
                
                // –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–µ–º –±–ª–æ–∫
                Object.keys(categorized).sort().forEach(category => {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'category';
                    
                    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    const categoryTitle = document.createElement('h2');
                    categoryTitle.textContent = `${category} (${categorized[category].length})`;
                    categoryDiv.appendChild(categoryTitle);
                    
                    // –°–ø–∏—Å–æ–∫ —Ä–µ–ª–∏–∑–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                    categorized[category].forEach(release => {
                        const releaseDiv = document.createElement('div');
                        releaseDiv.className = 'release';
                        
                        // –¢–µ–≥ –≤–µ—Ä—Å–∏–∏
                        const tagSpan = document.createElement('span');
                        tagSpan.className = 'tag';
                        tagSpan.textContent = release.tag_name;
                        releaseDiv.appendChild(tagSpan);
                        
                        // –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞
                        const titleLink = document.createElement('a');
                        titleLink.href = release.html_url;
                        titleLink.target = '_blank';
                        titleLink.innerHTML = `<strong>${release.name || release.tag_name}</strong>`;
                        releaseDiv.appendChild(titleLink);
                        
                        // –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
                        const dateSpan = document.createElement('p');
                        dateSpan.innerHTML = `<small>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: ${formatDate(release.published_at)}</small>`;
                        releaseDiv.appendChild(dateSpan);
                        
                        // –û–ø–∏—Å–∞–Ω–∏–µ (–ø–µ—Ä–≤—ã–µ 150 —Å–∏–º–≤–æ–ª–æ–≤)
                        if (release.body) {
                            const desc = document.createElement('p');
                            desc.textContent = release.body.substring(0, 150) + (release.body.length > 150 ? '...' : '');
                            releaseDiv.appendChild(desc);
                        }
                        
                        // –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                        if (release.assets && release.assets.length > 0) {
                            const fileList = document.createElement('div');
                            fileList.className = 'file-list';
                            fileList.innerHTML = '<strong>–§–∞–π–ª—ã:</strong><br>';
                            
                            release.assets.forEach(asset => {
                                const fileLink = document.createElement('a');
                                fileLink.href = asset.browser_download_url;
                                fileLink.target = '_blank';
                                fileLink.textContent = ` ${asset.name} (${Math.round(asset.size / 1024 / 1024 * 10) / 10} MB)`;
                                fileLink.style.display = 'block';
                                fileList.appendChild(fileLink);
                            });
                            
                            releaseDiv.appendChild(fileList);
                        }
                        
                        categoryDiv.appendChild(releaseDiv);
                    });
                    
                    container.appendChild(categoryDiv);
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                container.innerHTML = `<p class="error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ä–µ–ª–∏–∑–∞—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>`;
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', loadReleases);
    </script>

    <footer>
        <hr>
        <p><small>–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∏–∑ <a href="https://github.com/arkuid/padavan-ng-test-2/releases">GitHub Releases</a>. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</small></p>
    </footer>
</body>
</html>
